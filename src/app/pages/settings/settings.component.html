<app-header></app-header>
<div class="cont">
    <div class="settings">
        <div class="userInfo" *ngIf="currentUser">
            <img [src]="currentUser.image" alt="Profile Image" class="profile-img"/>
            <div class="userInfo__Content">
                <div class="userInfo__Name">
                    <h2>სახელი:</h2>
                    <ng-container *ngIf="!shouldEdit[0]; else editUsername">
                        <h2 class="userInfo__DataHolder">{{ currentUser.name }}</h2>
                    </ng-container>
                    
                    <ng-template #editUsername>
                        <div class="userInfo__Name__edit">
                            <input type="text" placeholder="ახალი სახელი" [value]="currentUser.name" [(ngModel)]="newName">
                            <button class="MentorBtn-Green userInfo__Name__edit__SubmitBtn" 
                            (click)="editProfile(currentUser._id, 'name', newName)">
                                შეცვლა
                            </button>
                        </div>
                    </ng-template>
                    <i class="fa-solid fa-pen-to-square" (click)="edit(0)"></i>   
                </div>
                <div class="userInfo__Email">
                    <h2>ელ–ფოსტა:</h2>
                    <ng-container *ngIf="!shouldEdit[1]; else editEmail">
                        <h2 class="userInfo__DataHolder">{{ currentUser.email }}</h2>
                    </ng-container>
                    
                    <ng-template #editEmail>
                        <div class="userInfo__Email__edit">
                            <input type="text" placeholder="ახალი ელ–ფოსტა" [value]="currentUser.email" [(ngModel)]="newEmail">
                            <button class="MentorBtn-Green userInfo__Email__edit__SubmitBtn" 
                            (click)="editProfile(currentUser._id, 'email', newEmail)">
                                შეცვლა
                            </button>
                        </div>
                    </ng-template>
                    <i class="fa-solid fa-pen-to-square" (click)="edit(1)"></i>   
                </div>
                <div class="userInfo__Password">
                    <h2>პაროლი:</h2>
                    <ng-container *ngIf="!shouldEdit[2]; else editPassword">
                        <h2 class="userInfo__DataHolder">{{ '•'.repeat(16) }}</h2>
                    </ng-container>
                    
                    <ng-template #editPassword>
                        <div class="userInfo__Password__edit">
                            <input type="text" placeholder="ახალი პაროლი" [value]="currentUser.password" [(ngModel)]="newPassword">
                            <button class="MentorBtn-Green userInfo__Password__edit__SubmitBtn" 
                            (click)="editProfile(currentUser._id, 'password', newPassword)">
                                შეცვლა
                            </button>
                        </div>
                    </ng-template>
                    
                    <i class="fa-solid fa-pen-to-square" (click)="edit(2)"></i>   
                </div>
                <div class="userInfo__Specialty">
                    <h2>პროფესია:</h2>
                    
                    <ng-container *ngIf="!shouldEdit[3]; else editSpecialty">
                        <h2 class="userInfo__DataHolder">{{ currentUser.position }}</h2>
                    </ng-container>
                    
                    <ng-template #editSpecialty>
                        <div class="userInfo__Specialty__edit">
                            <input type="text" placeholder="ახალი პროფესია" [value]="currentUser.position" [(ngModel)]="newSpecialty">
                            <button class="MentorBtn-Green userInfo__Specialty__edit__SubmitBtn"
                            (click)="editProfile(currentUser._id, 'position', newSpecialty)">
                                შეცვლა
                            </button>
                        </div>
                    </ng-template>
                    <i class="fa-solid fa-pen-to-square" (click)="edit(3)"></i>   
                </div>
            </div>
        </div>
        <div class="experience">
            <ul *ngFor="let Experience of experiences">
                <li>{{Experience.company}}</li>
                <li>{{Experience.position}}</li>
                <li>{{Experience.description}}</li>
            </ul>
            <form (ngSubmit)="addExperience()" [formGroup]="experience">
                <div class="resume">
                    <div class="resume__company">
                        <label for="Company">კომპანია</label>
                        <input type="text" name="Company" formControlName="company">
                        <p class="error">
                            {{ (experience.get('company')?.touched && experience.get('company')?.invalid) ?
                             'გთხოვთ შეიყვანოთ კომპანიის ან დაწესებულების სახელი (2–70 სიმბოლო)' : ''}}
                        </p>
                    </div>
                    <div class="resume__position">
                        <label for="Position">პოზიცია</label>
                        <input type="text" name="Position" formControlName="position">
                        <p class="error">
                            {{ (experience.get('position')?.touched && experience.get('position')?.invalid)?
                             'გთხოვთ შეიყვანოთ თანამდებობა (2–50 სიმბოლო)' : '' }}
                        </p>
                    </div>
                    <div class="resume__description">
                        <label for="Description">აღწერა</label>
                        <textarea name="Description" formControlName="description"></textarea>
                        <p class="error">{{ (experience.get('description')?.touched && experience.get('description')?.invalid)?
                            'გთხოვთ შეიყვანოთ აღწერილობა (10–100 სიმბოლო)' : ''}}
                        </p>
                    </div>
                    <div class="resume__topController">
                        <input type="checkbox" formControlName="isOnTop">
                        <p>ტოპ გამოცდილებებში დამატება</p>
                    </div>
                    <div class="resume__ButtonHolder">
                        <button class="MentorBtn-Green settingsBtn">დამატება</button>
                    </div>
                    <p class="error">{{textIsSpammy? 'გთხოვთ მოერიდოთ სპამს' : ''}}</p>
                </div>
            </form>
        </div>
    </div>
</div>

 